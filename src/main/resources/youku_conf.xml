<?xml version="1.0" encoding="UTF-8" ?>
<!--全局配置 -->
<conf>
	<globalSettings>
		<threadPoolSize>50</threadPoolSize>
		<timeout>10000</timeout>
		<reportProcess>true</reportProcess>
	</globalSettings>

	<!--作业配置 -->
	<jobs>
		<job>
			<name>movie</name>
			<!-- 定义 Fetcher -->
			<fetch>
				<!-- 默认为Default，如果有其他实现，填写类的全路径 -->
				<type>default</type>
				<agent>Kindle</agent>
				<threadNum>5</threadNum>
				<delayBetweenRequests>100</delayBetweenRequests>
				<maxDepthOfCrawling>-1</maxDepthOfCrawling>
				<maxOutgoingLinksToFollow>1000</maxOutgoingLinksToFollow>
				<fetchBinaryContent>false</fetchBinaryContent>
				<fileSuffix>gif,jpg,png,zip,rar,aiv,mtk</fileSuffix>
				<https>true</https>
				<onlyDomain>true</onlyDomain>
				<connection>
					<socketTimeoutMilliseconds>10000</socketTimeoutMilliseconds>
					<connectionTimeout>2000</connectionTimeout>
					<maxTotalConnections>120</maxTotalConnections>
					<maxConnectionsPerHost>100</maxConnectionsPerHost>
					<maxDownloadSizePerPage>1048576</maxDownloadSizePerPage>
				</connection>
				<proxy>
					<proxyHost></proxyHost>
					<proxyPort></proxyPort>
					<proxyUsername></proxyUsername>
					<proxyPassword></proxyPassword>
				</proxy>
				<seeds>
					<seed>http://www.youku.com/</seed>
				</seeds>
				<!-- 加入Url待处理队列的策略 -->
				<fetchUrlFilters>
				</fetchUrlFilters>
				<!-- 加入待抽取信息页队列的策略 -->
				<extractUrlfilters>
					<filter>http://.*.youku.com/show_page/.*</filter>
					<filter>http://.*.youku.com/star_page/.*</filter>
				</extractUrlfilters>
			</fetch>

			<!-- 定义extract -->
			<extract>
				<type>default</type>
				<threadNum>6</threadNum>
				<template>
					<urls>
						<url>http://.*.youku.com/show_page/.*</url>
					</urls>
					<selects>
						<select name="title" type="string" value=".title .name" attr="text" required="true" />
						<select name="category" type="string" value=".title .type a" attr="text" required="true">
							<!-- 条件判断、仅支持=判断 -->
							<if test="category=电影" ref="category">
								<select name="year" type="int" value=".tiltle .pub" attr="text" required="true"/>
								<select name="score" type="int" value=".ratingstar .num" attr="text" required="true"/>
								<select name="alias" type="string" value=".alias" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="area" type="string" value=".row2 .area a" attr="text" required="true"/>
								<select name="lang" type="string" value=".lang" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="type" type="list" value=".row2 .type a" attr="text" required="true"/>
								<select name="director" type="string" value=".row2 .director a" attr="text" />
								<select name="actors" type="list" value="actor a" attr="text" required="true"/>
								<select name="duration" type="int" value=".row2 .duration" attr="text" />
								<select name="hot" type="int" value=".row2 .vr .num" attr="text" />
								<select name="summary" type="string" value=".detail .long" attr="text" />
								<select name="thumbnail" type="string" value=".baseinfo .thumb img" attr="src" required="true"/>
								<select name="play1" type="url" value=".btnplayposi" attr="href">
									<select name="online" type="set" value="#link2" attr="value" />
								</select>
								<select name="play2" type="url" value="btnplaytrailer" attr="value">
									<select name="online" type="set" value="#link2" attr="value" />
								</select>
							</if>
							<if test="category=电视剧">
								<select name="year" type="int" value=".tiltle .pub" attr="text" required="true"/>
								<select name="score" type="int" value=".ratingstar .num" attr="text" required="true"/>
								<select name="alias" type="string" value=".alias" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="area" type="string" value=".row2 .area a" attr="text" required="true"/>
								<select name="lang" type="string" value=".lang" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="type" type="list" value=".row2 .type a" attr="text" required="true"/>
								<select name="director" type="string" value=".row2 .director a" attr="text" />
								<select name="actors" type="list" value=".actor a" attr="text" required="true"/>
								<select name="hot" type="int" value=".row2 .vr .num" attr="text" />
								<select name="summary" type="string" value="#show_info_short" attr="text" />
								<select name="thumbnail" type="string" value=".baseinfo .thumb img" attr="src" required="true"/>
								<!-- 剧集超过40需要模拟点击 #研究中 -->
								<select name="play1" type="url" value="#episode a" attr="href">
									<select name="online" type="set" value="#link2" attr="value" />
								</select>
							</if>
							<if test="category=综艺">
								<select name="year" type="int" value=".tiltle .pub" attr="text"/>
								<select name="score" type="int" value=".ratingstar .num" attr="text" required="true"/>
								<select name="area" type="string" value=".row2 .area a" attr="text" required="true"/>
								<select name="lang" type="string" value=".lang" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="host" type="string" value=".row1 .host a" attr="text"/>
								<select name="hot" type="int" value=".row2 .vr .num" attr="text" />
								<select name="summary" type="string" value="#show_info_short" attr="text" />
								<select name="thumbnail" type="string" value=".baseinfo .thumb img" attr="src" required="true"/>
								<!-- 剧集超过40需要模拟点击 #研究中 -->
								<select name="play1" type="url" value="#episode a" attr="href">
									<select name="online" type="set" value="#link2" attr="value" />
								</select>
							</if>
							<if test="category=动漫">
								<select name="year" type="int" value=".tiltle .pub" attr="text" required="true"/>
								<select name="score" type="int" value=".ratingstar .num" attr="text" required="true"/>
								<select name="alias" type="string" value=".alias" attr="text">
									<action opration="split" separator=":" retain="1"></action>
								</select>
								<select name="area" type="string" value=".row2 .area a" attr="text" required="true"/>
								<select name="type" type="list" value=".row2 .type a" attr="text" required="true"/>
								<select name="hot" type="int" value=".row2 .vr .num" attr="text" />
								<select name="summary" type="string" value=".detail .long" attr="text" />
								<select name="thumbnail" type="string" value=".baseinfo .thumb img" attr="src" required="true"/>
								<select name="play1" type="url" value="#episode a" attr="href">
									<select name="online" type="set" value="#link2" attr="value" />
								</select>
							</if>
						</select>
					</selects>
				</template>
				<!-- 音乐 
				<template url="http://.*.youku.com/star_page/.*">
					<selects>
						<select name="name" type="string" value="star_name" attr="text" required="true" />
						<select name="category" type="string" value=".title .type a" attr="text" required="true"/>
						<if test="category=">
							<select name="year" type="int" value=".tiltle .pub" attr="text" required="true"/>
							<select name="score" type="int" value=".ratingstar .num" attr="text" required="true"/>
							<select name="alias" type="string" value=".alias" attr="text">
								<action opration="split" separator=":" retain="1"></action>
							</select>
							<select name="area" type="string" value=".row2 .area a" attr="text" required="true"/>
							<select name="lang" type="string" value=".lang" attr="text">
								<action opration="split" separator=":" retain="1"></action>
							</select>
							<select name="type" type="list" value=".row2 .type a" attr="text" required="true"/>
							<select name="director" type="string" value=".row2 .director a" attr="text" />
							<select name="actors" type="list" value="actor a" attr="text" required="true"/>
							<select name="duration" type="int" value=".row2 .duration" attr="text" />
							<select name="hot" type="int" value=".row2 .vr .num" attr="text" />
							<select name="summary" type="string" value=".detail .long" attr="text" />
							<select name="thumbnail" type="string" value=".baseinfo .thumb img" attr="src" required="true"/>
							<select name="play1" type="url" value=".btnplayposi" attr="href">
								<select name="online" type="set" value="#link2" attr="value" />
							</select>
							<select name="play2" type="url" value="btnplaytrailer" attr="value">
								<select name="online" type="set" value="#link2" attr="value" />
							</select>
						</if>
					</selects>
				</template>
				-->
			</extract>
			<!-- 存储配置 -->
			<store>
				<type>default</type>
				<threadNum>6</threadNum>
			</store>

			<!-- job运行时效，-1表示直到爬完全部，60表示一个小时后job自动结束 -->
			<timeout>-1</timeout>
		</job>
	</jobs>
</conf>